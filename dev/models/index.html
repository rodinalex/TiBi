
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://rodinalex.github.io/TiBi/dev/models/">
      
      
        <link rel="prev" href="../logic/">
      
      
        <link rel="next" href="../ui/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Models - TiBi</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#TiBi.models.BandStructure" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="TiBi" class="md-header__button md-logo" aria-label="TiBi" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TiBi
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Models
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/rodinalex/TiBi" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../user_guide/install/" class="md-tabs__link">
          
  
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../architecture/" class="md-tabs__link">
          
  
  
  Developer Guide

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="TiBi" class="md-nav__button md-logo" aria-label="TiBi" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    TiBi
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/rodinalex/TiBi" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user_guide/bands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Band structure and DOS
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Developer Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Developer Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../controllers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Controllers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../logic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logic
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.BandStructure" class="md-nav__link">
    <span class="md-ellipsis">
      BandStructure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BandStructure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#TiBi.models.BandStructure.add_point" class="md-nav__link">
    <span class="md-ellipsis">
      add_point
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TiBi.models.BandStructure.clear" class="md-nav__link">
    <span class="md-ellipsis">
      clear
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TiBi.models.BandStructure.remove_point" class="md-nav__link">
    <span class="md-ellipsis">
      remove_point
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TiBi.models.BandStructure.reset_bands" class="md-nav__link">
    <span class="md-ellipsis">
      reset_bands
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.BasisVector" class="md-nav__link">
    <span class="md-ellipsis">
      BasisVector
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BasisVector">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#TiBi.models.BasisVector.as_array" class="md-nav__link">
    <span class="md-ellipsis">
      as_array
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.BrillouinZoneGrid" class="md-nav__link">
    <span class="md-ellipsis">
      BrillouinZoneGrid
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BrillouinZoneGrid">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#TiBi.models.BrillouinZoneGrid.clear" class="md-nav__link">
    <span class="md-ellipsis">
      clear
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.Selection" class="md-nav__link">
    <span class="md-ellipsis">
      Selection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Selection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#TiBi.models.Selection.set_selection" class="md-nav__link">
    <span class="md-ellipsis">
      set_selection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.Site" class="md-nav__link">
    <span class="md-ellipsis">
      Site
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.State" class="md-nav__link">
    <span class="md-ellipsis">
      State
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.UnitCell" class="md-nav__link">
    <span class="md-ellipsis">
      UnitCell
    </span>
  </a>
  
    <nav class="md-nav" aria-label="UnitCell">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#TiBi.models.UnitCell.get_BZ" class="md-nav__link">
    <span class="md-ellipsis">
      get_BZ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TiBi.models.UnitCell.get_hamiltonian_function" class="md-nav__link">
    <span class="md-ellipsis">
      get_hamiltonian_function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TiBi.models.UnitCell.get_states" class="md-nav__link">
    <span class="md-ellipsis">
      get_states
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TiBi.models.UnitCell.is_hermitian" class="md-nav__link">
    <span class="md-ellipsis">
      is_hermitian
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TiBi.models.UnitCell.reciprocal_vectors" class="md-nav__link">
    <span class="md-ellipsis">
      reciprocal_vectors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TiBi.models.UnitCell.reduced_basis" class="md-nav__link">
    <span class="md-ellipsis">
      reduced_basis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TiBi.models.UnitCell.volume" class="md-nav__link">
    <span class="md-ellipsis">
      volume
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.factories.bz_point_selection_init" class="md-nav__link">
    <span class="md-ellipsis">
      bz_point_selection_init
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.factories.bz_point_lists_init" class="md-nav__link">
    <span class="md-ellipsis">
      bz_point_lists_init
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.factories.mk_new_site" class="md-nav__link">
    <span class="md-ellipsis">
      mk_new_site
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.factories.mk_new_state" class="md-nav__link">
    <span class="md-ellipsis">
      mk_new_state
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.factories.mk_new_unit_cell" class="md-nav__link">
    <span class="md-ellipsis">
      mk_new_unit_cell
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../views/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Views
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.BandStructure" class="md-nav__link">
    <span class="md-ellipsis">
      BandStructure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BandStructure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#TiBi.models.BandStructure.add_point" class="md-nav__link">
    <span class="md-ellipsis">
      add_point
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TiBi.models.BandStructure.clear" class="md-nav__link">
    <span class="md-ellipsis">
      clear
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TiBi.models.BandStructure.remove_point" class="md-nav__link">
    <span class="md-ellipsis">
      remove_point
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TiBi.models.BandStructure.reset_bands" class="md-nav__link">
    <span class="md-ellipsis">
      reset_bands
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.BasisVector" class="md-nav__link">
    <span class="md-ellipsis">
      BasisVector
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BasisVector">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#TiBi.models.BasisVector.as_array" class="md-nav__link">
    <span class="md-ellipsis">
      as_array
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.BrillouinZoneGrid" class="md-nav__link">
    <span class="md-ellipsis">
      BrillouinZoneGrid
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BrillouinZoneGrid">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#TiBi.models.BrillouinZoneGrid.clear" class="md-nav__link">
    <span class="md-ellipsis">
      clear
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.Selection" class="md-nav__link">
    <span class="md-ellipsis">
      Selection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Selection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#TiBi.models.Selection.set_selection" class="md-nav__link">
    <span class="md-ellipsis">
      set_selection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.Site" class="md-nav__link">
    <span class="md-ellipsis">
      Site
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.State" class="md-nav__link">
    <span class="md-ellipsis">
      State
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.UnitCell" class="md-nav__link">
    <span class="md-ellipsis">
      UnitCell
    </span>
  </a>
  
    <nav class="md-nav" aria-label="UnitCell">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#TiBi.models.UnitCell.get_BZ" class="md-nav__link">
    <span class="md-ellipsis">
      get_BZ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TiBi.models.UnitCell.get_hamiltonian_function" class="md-nav__link">
    <span class="md-ellipsis">
      get_hamiltonian_function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TiBi.models.UnitCell.get_states" class="md-nav__link">
    <span class="md-ellipsis">
      get_states
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TiBi.models.UnitCell.is_hermitian" class="md-nav__link">
    <span class="md-ellipsis">
      is_hermitian
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TiBi.models.UnitCell.reciprocal_vectors" class="md-nav__link">
    <span class="md-ellipsis">
      reciprocal_vectors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TiBi.models.UnitCell.reduced_basis" class="md-nav__link">
    <span class="md-ellipsis">
      reduced_basis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#TiBi.models.UnitCell.volume" class="md-nav__link">
    <span class="md-ellipsis">
      volume
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.factories.bz_point_selection_init" class="md-nav__link">
    <span class="md-ellipsis">
      bz_point_selection_init
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.factories.bz_point_lists_init" class="md-nav__link">
    <span class="md-ellipsis">
      bz_point_lists_init
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.factories.mk_new_site" class="md-nav__link">
    <span class="md-ellipsis">
      mk_new_site
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.factories.mk_new_state" class="md-nav__link">
    <span class="md-ellipsis">
      mk_new_state
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#TiBi.models.factories.mk_new_unit_cell" class="md-nav__link">
    <span class="md-ellipsis">
      mk_new_unit_cell
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Models</h1>

<p>This page provides the documentation for the data models used by the Application, as well as relevant factories.</p>


<div class="doc doc-object doc-class">



<h2 id="TiBi.models.BandStructure" class="doc doc-heading">
            <code>TiBi.models.BandStructure</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#TiBi.models.BandStructure" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">


        <p>A <code>UnitCell</code> attribute containing a system's band structure.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.BandStructure.path">path</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of point coordinates along which the bands are calculated.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.BandStructure.special_points">special_points</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of high-symmetry point coordinates used for the path.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.BandStructure.eigenvalues">eigenvalues</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of arrays, where each array contains eigenvalues (energies)
corresponding to each point on the path.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.BandStructure.eigenvectors">eigenvectors</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of square 2D arrays, where each array contains the eigenvectors
corresponding to each point on the path. The
eigenvectors are the columns of the 2D arrays.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="clear() (TiBi.models.BandStructure.clear)" href="#TiBi.models.BandStructure.clear">clear</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Reset the <code>BandStructure</code> to the initial state.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="reset_bands() (TiBi.models.BandStructure.reset_bands)" href="#TiBi.models.BandStructure.reset_bands">reset_bands</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Reset the <code>BandStructure</code> by clearing the path, eigenvalues, and
eigenvectors, but keeping the special points.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="add_point(point) (TiBi.models.BandStructure.add_point)" href="#TiBi.models.BandStructure.add_point">add_point</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Add a point to the special points path. Reset all other fields.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="remove_point() (TiBi.models.BandStructure.remove_point)" href="#TiBi.models.BandStructure.remove_point">remove_point</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Remove the last point from the special points path. Reset all other
fields.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>TiBi/models/band_structure.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BandStructure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A `UnitCell` attribute containing a system&#39;s band structure.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    path : list[NDArray[np.float64]]</span>
<span class="sd">        A list of point coordinates along which the bands are calculated.</span>
<span class="sd">    special_points : list[NDArray[np.float64]]</span>
<span class="sd">        A list of high-symmetry point coordinates used for the path.</span>
<span class="sd">    eigenvalues : list[NDArray[np.float64]]</span>
<span class="sd">        A list of arrays, where each array contains eigenvalues (energies)</span>
<span class="sd">        corresponding to each point on the path.</span>
<span class="sd">    eigenvectors : list[NDArray[np.float64]]</span>
<span class="sd">        A list of square 2D arrays, where each array contains the eigenvectors</span>
<span class="sd">        corresponding to each point on the path. The</span>
<span class="sd">        eigenvectors are the columns of the 2D arrays.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    clear()</span>
<span class="sd">        Reset the `BandStructure` to the initial state.</span>
<span class="sd">    reset_bands()</span>
<span class="sd">        Reset the `BandStructure` by clearing the path, eigenvalues, and</span>
<span class="sd">        eigenvectors, but keeping the special points.</span>
<span class="sd">    add_point(point: NDArray[np.float64])</span>
<span class="sd">        Add a point to the special points path. Reset all other fields.</span>
<span class="sd">    remove_point()</span>
<span class="sd">        Remove the last point from the special points path. Reset all other</span>
<span class="sd">        fields.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">path</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">special_points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">eigenvalues</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">eigenvectors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reset the `BandStructure` to the initial state.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">special_points</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_bands</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reset_bands</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reset the `BandStructure` by clearing the path, eigenvalues, and</span>
<span class="sd">        eigenvectors, but keeping the special points.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eigenvalues</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eigenvectors</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a point to the special points path. Reset all other fields.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        point : NDArray[np.float64]</span>
<span class="sd">            The point to be added to the special points path.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_bands</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">special_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">remove_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove the last point from the special points path. Reset all other</span>
<span class="sd">        fields.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">special_points</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">special_points</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset_bands</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="TiBi.models.BandStructure.add_point" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_point</span><span class="p">(</span><span class="n">point</span><span class="p">)</span></code>

<a href="#TiBi.models.BandStructure.add_point" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Add a point to the special points path. Reset all other fields.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>point</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The point to be added to the special points path.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>TiBi/models/band_structure.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add a point to the special points path. Reset all other fields.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    point : NDArray[np.float64]</span>
<span class="sd">        The point to be added to the special points path.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reset_bands</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">special_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="TiBi.models.BandStructure.clear" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">clear</span><span class="p">()</span></code>

<a href="#TiBi.models.BandStructure.clear" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Reset the <code>BandStructure</code> to the initial state.</p>


            <details class="quote">
              <summary>Source code in <code>TiBi/models/band_structure.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reset the `BandStructure` to the initial state.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">special_points</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reset_bands</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="TiBi.models.BandStructure.remove_point" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_point</span><span class="p">()</span></code>

<a href="#TiBi.models.BandStructure.remove_point" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Remove the last point from the special points path. Reset all other
fields.</p>


            <details class="quote">
              <summary>Source code in <code>TiBi/models/band_structure.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Remove the last point from the special points path. Reset all other</span>
<span class="sd">    fields.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">special_points</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">special_points</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_bands</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="TiBi.models.BandStructure.reset_bands" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reset_bands</span><span class="p">()</span></code>

<a href="#TiBi.models.BandStructure.reset_bands" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Reset the <code>BandStructure</code> by clearing the path, eigenvalues, and
eigenvectors, but keeping the special points.</p>


            <details class="quote">
              <summary>Source code in <code>TiBi/models/band_structure.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reset_bands</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reset the `BandStructure` by clearing the path, eigenvalues, and</span>
<span class="sd">    eigenvectors, but keeping the special points.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">eigenvalues</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">eigenvectors</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="TiBi.models.BasisVector" class="doc doc-heading">
            <code>TiBi.models.BasisVector</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#TiBi.models.BasisVector" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">


        <p>A basis vector in 3D space for a crystalline unit cell.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.BasisVector.x">x</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>x-component in Cartesian coordinates</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.BasisVector.y">y</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>y-component in Cartesian coordinates</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.BasisVector.z">z</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>z-component in Cartesian coordinates</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.BasisVector.is_periodic">is_periodic</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag denoting whether the crystal repeats in this direction</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="as_array() (TiBi.models.BasisVector.as_array)" href="#TiBi.models.BasisVector.as_array">as_array</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Convert the <code>BasisVector</code> to a NumPy array with 3 elements.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>TiBi/models/basis_vector.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BasisVector</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A basis vector in 3D space for a crystalline unit cell.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    x : float</span>
<span class="sd">        x-component in Cartesian coordinates</span>
<span class="sd">    y : float</span>
<span class="sd">        y-component in Cartesian coordinates</span>
<span class="sd">    z : float</span>
<span class="sd">        z-component in Cartesian coordinates</span>
<span class="sd">    is_periodic : bool</span>
<span class="sd">        Flag denoting whether the crystal repeats in this direction</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    as_array()</span>
<span class="sd">        Convert the `BasisVector` to a NumPy array with 3 elements.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">x</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">y</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">z</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">is_periodic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">as_array</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the `BasisVector` to a NumPy array.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[np.float64]</span>
<span class="sd">            3D vector as a NumPy array [x, y, z]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="TiBi.models.BasisVector.as_array" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">as_array</span><span class="p">()</span></code>

<a href="#TiBi.models.BasisVector.as_array" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Convert the <code>BasisVector</code> to a NumPy array.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>3D vector as a NumPy array [x, y, z]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>TiBi/models/basis_vector.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">as_array</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert the `BasisVector` to a NumPy array.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    NDArray[np.float64]</span>
<span class="sd">        3D vector as a NumPy array [x, y, z]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="TiBi.models.BrillouinZoneGrid" class="doc doc-heading">
            <code>TiBi.models.BrillouinZoneGrid</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#TiBi.models.BrillouinZoneGrid" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">


        <p>A <code>UnitCell</code> attribute containing a system's computed Brillouin zone grid.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.BrillouinZoneGrid.is_gamma_centered">is_gamma_centered</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A boolean marking whether the grid is Gamma centered or Monkhorst-Pack</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.BrillouinZoneGrid.grid_divs">grid_divs</span></code></td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of divisions along each reciprocal basis vector</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.BrillouinZoneGrid.k_points">k_points</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The coordinates of the grid points.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.BrillouinZoneGrid.eigenvalues">eigenvalues</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of arrays, where each array contains eigenvalues (energies)
corresponding to each grid point.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.BrillouinZoneGrid.eigenvectors">eigenvectors</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of square 2D arrays, where each array contains the eigenvectors
corresponding to each grid point. The
eigenvectors are the columns of the 2D arrays.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="clear() (TiBi.models.BrillouinZoneGrid.clear)" href="#TiBi.models.BrillouinZoneGrid.clear">clear</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Reset the grid to the initial state.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>TiBi/models/bz_grid.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BrillouinZoneGrid</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A `UnitCell` attribute containing a system&#39;s computed Brillouin zone grid.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    is_gamma_centered : bool</span>
<span class="sd">        A boolean marking whether the grid is Gamma centered or Monkhorst-Pack</span>
<span class="sd">    grid_divs : tuple[int, int, int]</span>
<span class="sd">        Number of divisions along each reciprocal basis vector</span>
<span class="sd">    k_points : list[NDArray[np.float64]]</span>
<span class="sd">        The coordinates of the grid points.</span>
<span class="sd">    eigenvalues : list[NDArray[np.float64]]</span>
<span class="sd">        A list of arrays, where each array contains eigenvalues (energies)</span>
<span class="sd">        corresponding to each grid point.</span>
<span class="sd">    eigenvectors : list[NDArray[np.float64]]</span>
<span class="sd">        A list of square 2D arrays, where each array contains the eigenvectors</span>
<span class="sd">        corresponding to each grid point. The</span>
<span class="sd">        eigenvectors are the columns of the 2D arrays.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    clear()</span>
<span class="sd">        Reset the grid to the initial state.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">is_gamma_centered</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">grid_divs</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">k_points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">eigenvalues</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">eigenvectors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reset the grid to the initial state.</span>

<span class="sd">        The k points, eigenvalues, and eigenvectors are cleared,</span>
<span class="sd">        while the gamma-centered flag and the grid divisions remain unchanged.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_points</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eigenvalues</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eigenvectors</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="TiBi.models.BrillouinZoneGrid.clear" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">clear</span><span class="p">()</span></code>

<a href="#TiBi.models.BrillouinZoneGrid.clear" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Reset the grid to the initial state.</p>
<p>The k points, eigenvalues, and eigenvectors are cleared,
while the gamma-centered flag and the grid divisions remain unchanged.</p>


            <details class="quote">
              <summary>Source code in <code>TiBi/models/bz_grid.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reset the grid to the initial state.</span>

<span class="sd">    The k points, eigenvalues, and eigenvectors are cleared,</span>
<span class="sd">    while the gamma-centered flag and the grid divisions remain unchanged.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">k_points</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">eigenvalues</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">eigenvectors</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="TiBi.models.Selection" class="doc doc-heading">
            <code>TiBi.models.Selection</code>


<a href="#TiBi.models.Selection" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="PySide6.QtCore.QObject">QObject</span></code></p>


        <p>Currently selected item.</p>
<p>The item is characterized by a series of uuid.UUID's
that can be viewed as a hierarchical address.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.Selection.unit_cell">unit_cell</span></code></td>
            <td>
                  <code><span title="uuid.UUID">UUID</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ID of the selected <code>UnitCell</code></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.Selection.site">site</span></code></td>
            <td>
                  <code><span title="uuid.UUID">UUID</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ID of the selected <code>Site</code></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.Selection.state">state</span></code></td>
            <td>
                  <code><span title="uuid.UUID">UUID</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ID of the selected <code>State</code></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.Selection.unit_cell_updated">unit_cell_updated</span></code></td>
            <td>
                  <code><span title="PySide6.QtCore.Signal">Signal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Emitted when a new <code>UnitCell</code> is selected.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.Selection.site_updated">site_updated</span></code></td>
            <td>
                  <code><span title="PySide6.QtCore.Signal">Signal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Emitted when a new <code>Site</code> is selected.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.Selection.state_updated">state_updated</span></code></td>
            <td>
                  <code><span title="PySide6.QtCore.Signal">Signal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Emitted when a new <code>State</code> is selected.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.Selection.selection_changed">selection_changed</span></code></td>
            <td>
                  <code><span title="PySide6.QtCore.Signal">Signal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Emitted when the selection changes, in addition
to the specific signal.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="set_selection(uc_id, site_id, state_id) (TiBi.models.Selection.set_selection)" href="#TiBi.models.Selection.set_selection">set_selection</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Update the selection and emit an appropriate signal.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>TiBi/models/selection.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Selection</span><span class="p">(</span><span class="n">QObject</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Currently selected item.</span>

<span class="sd">    The item is characterized by a series of uuid.UUID&#39;s</span>
<span class="sd">    that can be viewed as a hierarchical address.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    unit_cell : uuid.UUID | None</span>
<span class="sd">        ID of the selected `UnitCell`</span>
<span class="sd">    site : uuid.UUID | None</span>
<span class="sd">        ID of the selected `Site`</span>
<span class="sd">    state : uuid.UUID | None</span>
<span class="sd">        ID of the selected `State`</span>
<span class="sd">    unit_cell_updated : Signal</span>
<span class="sd">        Emitted when a new `UnitCell` is selected.</span>
<span class="sd">    site_updated : Signal</span>
<span class="sd">        Emitted when a new `Site` is selected.</span>
<span class="sd">    state_updated : Signal</span>
<span class="sd">        Emitted when a new `State` is selected.</span>
<span class="sd">    selection_changed : Signal</span>
<span class="sd">        Emitted when the selection changes, in addition</span>
<span class="sd">        to the specific signal.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    set_selection(uc_id : uuid.UUID | None, site_id : uuid.UUID | None,\</span>
<span class="sd">          state_id : uuid.UUID | None)</span>
<span class="sd">        Update the selection and emit an appropriate signal.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">unit_cell_updated</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">()</span>
    <span class="n">site_updated</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">()</span>
    <span class="n">state_updated</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">()</span>
    <span class="n">selection_changed</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">site</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uc_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="n">state_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the selection and emit an appropriate signal.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        uc_id : uuid.UUID | None</span>
<span class="sd">            New `UnitCell` id.</span>
<span class="sd">        site_id : uuid.UUID | None</span>
<span class="sd">            New `Site` id.</span>
<span class="sd">        state_id : uuid.UUID | None</span>
<span class="sd">            New `State` id.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">current_uc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell</span>
        <span class="n">current_site</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">site</span>
        <span class="n">current_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell</span> <span class="o">=</span> <span class="n">uc_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">site</span> <span class="o">=</span> <span class="n">site_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">state_id</span>

        <span class="k">if</span> <span class="n">current_uc</span> <span class="o">!=</span> <span class="n">uc_id</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell_updated</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selection_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">current_site</span> <span class="o">!=</span> <span class="n">site_id</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">site_updated</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selection_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">current_state</span> <span class="o">!=</span> <span class="n">state_id</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state_updated</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selection_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="TiBi.models.Selection.set_selection" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_selection</span><span class="p">(</span><span class="n">uc_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="n">state_id</span><span class="p">)</span></code>

<a href="#TiBi.models.Selection.set_selection" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Update the selection and emit an appropriate signal.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>uc_id</code>
            </td>
            <td>
                  <code><span title="uuid.UUID">UUID</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New <code>UnitCell</code> id.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>site_id</code>
            </td>
            <td>
                  <code><span title="uuid.UUID">UUID</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New <code>Site</code> id.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>state_id</code>
            </td>
            <td>
                  <code><span title="uuid.UUID">UUID</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New <code>State</code> id.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>TiBi/models/selection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uc_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="n">state_id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the selection and emit an appropriate signal.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    uc_id : uuid.UUID | None</span>
<span class="sd">        New `UnitCell` id.</span>
<span class="sd">    site_id : uuid.UUID | None</span>
<span class="sd">        New `Site` id.</span>
<span class="sd">    state_id : uuid.UUID | None</span>
<span class="sd">        New `State` id.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">current_uc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell</span>
    <span class="n">current_site</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">site</span>
    <span class="n">current_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell</span> <span class="o">=</span> <span class="n">uc_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">site</span> <span class="o">=</span> <span class="n">site_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">state_id</span>

    <span class="k">if</span> <span class="n">current_uc</span> <span class="o">!=</span> <span class="n">uc_id</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell_updated</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">current_site</span> <span class="o">!=</span> <span class="n">site_id</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">site_updated</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">current_state</span> <span class="o">!=</span> <span class="n">state_id</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_updated</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="TiBi.models.Site" class="doc doc-heading">
            <code>TiBi.models.Site</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#TiBi.models.Site" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">


        <p>A physical site (like an atom) within a <code>UnitCell</code>.</p>
<p><code>Site</code>s are positioned using fractional coordinates relative to
the <code>UnitCell</code>'s basis vectors, where each coordinate ranges from 0 to 1.
Each <code>Site</code> can contain multiple <code>State</code>s.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.Site.name">name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the <code>Site</code> (e.g., atom name like "C", "Fe", etc.)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.Site.c1, c2, c3">c1, c2, c3</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fractional coordinates (0  c  1) along the unit cell's <code>BasisVector</code>s</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.Site.R">R</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>Site</code> radius used for plotting (in arbitrary units)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.Site.color">color</span></code></td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>Site</code> RGBA color used for plotting (0-1 range for each channel)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.Site.states">states</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="uuid.UUID">UUID</span>, <a class="autorefs autorefs-internal" title="TiBi.models.State


  
      dataclass
   (TiBi.models.state.State)" href="#TiBi.models.State">State</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping state UUIDs to <code>State</code> objects</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.Site.id">id</span></code></td>
            <td>
                  <code><span title="uuid.UUID">UUID</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unique identifier for the <code>Site</code></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>TiBi/models/site.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Site</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A physical site (like an atom) within a `UnitCell`.</span>

<span class="sd">    `Site`s are positioned using fractional coordinates relative to</span>
<span class="sd">    the `UnitCell`&#39;s basis vectors, where each coordinate ranges from 0 to 1.</span>
<span class="sd">    Each `Site` can contain multiple `State`s.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        Name of the `Site` (e.g., atom name like &quot;C&quot;, &quot;Fe&quot;, etc.)</span>
<span class="sd">    c1, c2, c3 : float</span>
<span class="sd">        Fractional coordinates (0  c  1) along the unit cell&#39;s `BasisVector`s</span>
<span class="sd">    R : float</span>
<span class="sd">        `Site` radius used for plotting (in arbitrary units)</span>
<span class="sd">    color : tuple[float, float, float, float]</span>
<span class="sd">        `Site` RGBA color used for plotting (0-1 range for each channel)</span>
<span class="sd">    states : dict[uuid.UUID, State]</span>
<span class="sd">        Dictionary mapping state UUIDs to `State` objects</span>
<span class="sd">    id : uuid.UUID</span>
<span class="sd">        Unique identifier for the `Site`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">c1</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">c2</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">c3</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">R</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">color</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
    <span class="n">states</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="n">State</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="TiBi.models.State" class="doc doc-heading">
            <code>TiBi.models.State</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#TiBi.models.State" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">


        <p>A quantum state (orbital) within a <code>Site</code>.</p>
<p>Each <code>State</code> has a <code>name</code> and belongs to a <code>Site</code> in the <code>UnitCell</code>.
<code>State</code>s are the fundamental entities between which hopping can occur.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.State.name">name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the <code>State</code> (e.g., "s", "px", "py", etc.)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.State.id">id</span></code></td>
            <td>
                  <code><span title="uuid.UUID">UUID</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unique identifier for the <code>State</code></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>TiBi/models/state.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">State</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A quantum state (orbital) within a `Site`.</span>

<span class="sd">    Each `State` has a `name` and belongs to a `Site` in the `UnitCell`.</span>
<span class="sd">    `State`s are the fundamental entities between which hopping can occur.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        Name of the `State` (e.g., &quot;s&quot;, &quot;px&quot;, &quot;py&quot;, etc.)</span>
<span class="sd">    id : uuid.UUID</span>
<span class="sd">        Unique identifier for the `State`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="TiBi.models.UnitCell" class="doc doc-heading">
            <code>TiBi.models.UnitCell</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#TiBi.models.UnitCell" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">


        <p>The funtamental object describing a crystal.</p>
<p>The <code>UnitCell</code> is defined by three <code>BasisVector</code>s and contains <code>Site</code>s
and hopping terms between <code>State</code>s. Additionally, <code>UnitCell</code> carries
the calculated <code>BandStructure</code> and <code>BrillouinZoneGrid</code> objects.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.UnitCell.name">name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the unit cell</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.UnitCell.v1, v2, v3">v1, v2, v3</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TiBi.models.BasisVector


  
      dataclass
   (TiBi.models.basis_vector.BasisVector)" href="#TiBi.models.BasisVector">BasisVector</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Basis vectors</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.UnitCell.sites">sites</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="uuid.UUID">UUID</span>, <a class="autorefs autorefs-internal" title="TiBi.models.Site


  
      dataclass
   (TiBi.models.site.Site)" href="#TiBi.models.Site">Site</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping site UUIDs to <code>Site</code> objects</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.UnitCell.hoppings">hoppings</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="tuple">tuple</span>[<span title="uuid.UUID">UUID</span>, <span title="uuid.UUID">UUID</span>], <span title="list">list</span>[<span title="tuple">tuple</span>[<span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>], <span title="numpy.complex128">complex128</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of hopping terms between states.
Keys are pairs of state UUIDs (destination_state_id,
source_state_id).
Values are lists of (displacement, amplitude) pairs where:</p>
<ul>
<li>displacement is a tuple of three integers (n1,n2,n3) indicating
which periodic image of the unit cell is involved
(0,0,0 means within the same unit cell)</li>
<li>amplitude is a complex number</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.UnitCell.bandstructure">bandstructure</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TiBi.models.BandStructure


  
      dataclass
   (TiBi.models.band_structure.BandStructure)" href="#TiBi.models.BandStructure">BandStructure</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Band structure object for the <code>UnitCell</code></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.UnitCell.bz_grid">bz_grid</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TiBi.models.BrillouinZoneGrid


  
      dataclass
   (TiBi.models.bz_grid.BrillouinZoneGrid)" href="#TiBi.models.BrillouinZoneGrid">BrillouinZoneGrid</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Grid of points in the Brillouin zone</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="TiBi.models.UnitCell.id">id</span></code></td>
            <td>
                  <code><span title="uuid.UUID">UUID</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unique identifier for the <code>UnitCell</code></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="volume() (TiBi.models.UnitCell.volume)" href="#TiBi.models.UnitCell.volume">volume</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Compute the volume of the <code>UnitCell</code> using the scalar triple
product.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="is_hermitian() (TiBi.models.UnitCell.is_hermitian)" href="#TiBi.models.UnitCell.is_hermitian">is_hermitian</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Check whether the hoppings are Hermitian.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="reciprocal_vectors() (TiBi.models.UnitCell.reciprocal_vectors)" href="#TiBi.models.UnitCell.reciprocal_vectors">reciprocal_vectors</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Compute the reciprocal lattice vectors for the periodic directions.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="reduced_basis(scale=1000000.0) (TiBi.models.UnitCell.reduced_basis)" href="#TiBi.models.UnitCell.reduced_basis">reduced_basis</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Return a reduced set of periodic <code>BasisVector</code>s using LLL
algorithm.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="get_states() (TiBi.models.UnitCell.get_states)" href="#TiBi.models.UnitCell.get_states">get_states</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Extract all <code>State</code>s from a <code>UnitCell</code> along with their identifying
information.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="get_BZ() (TiBi.models.UnitCell.get_BZ)" href="#TiBi.models.UnitCell.get_BZ">get_BZ</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Compute the Brillouin zone vertices and faces.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="get_hamiltonian_function() (TiBi.models.UnitCell.get_hamiltonian_function)" href="#TiBi.models.UnitCell.get_hamiltonian_function">get_hamiltonian_function</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generate a function that computes the Hamiltonian matrix
for a given k-point.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>TiBi/models/unit_cell.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UnitCell</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The funtamental object describing a crystal.</span>

<span class="sd">    The `UnitCell` is defined by three `BasisVector`s and contains `Site`s</span>
<span class="sd">    and hopping terms between `State`s. Additionally, `UnitCell` carries</span>
<span class="sd">    the calculated `BandStructure` and `BrillouinZoneGrid` objects.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        Name of the unit cell</span>
<span class="sd">    v1, v2, v3 : BasisVector</span>
<span class="sd">        Basis vectors</span>
<span class="sd">    sites : dict[uuid.UUID, Site]</span>
<span class="sd">        Dictionary mapping site UUIDs to `Site` objects</span>
<span class="sd">    hoppings : dict[tuple[uuid.UUID, uuid.UUID], \</span>
<span class="sd">        list[tuple[tuple[int, int, int], np.complex128]]]</span>
<span class="sd">        Dictionary of hopping terms between states.</span>
<span class="sd">        Keys are pairs of state UUIDs (destination_state_id,</span>
<span class="sd">        source_state_id).</span>
<span class="sd">        Values are lists of (displacement, amplitude) pairs where:</span>

<span class="sd">        - displacement is a tuple of three integers (n1,n2,n3) indicating</span>
<span class="sd">        which periodic image of the unit cell is involved</span>
<span class="sd">        (0,0,0 means within the same unit cell)</span>
<span class="sd">        - amplitude is a complex number</span>
<span class="sd">    bandstructure : BandStructure</span>
<span class="sd">        Band structure object for the `UnitCell`</span>
<span class="sd">    bz_grid: BrillouinZoneGrid</span>
<span class="sd">        Grid of points in the Brillouin zone</span>
<span class="sd">    id : uuid.UUID</span>
<span class="sd">        Unique identifier for the `UnitCell`</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    volume()</span>
<span class="sd">        Compute the volume of the `UnitCell` using the scalar triple</span>
<span class="sd">        product.</span>
<span class="sd">    is_hermitian()</span>
<span class="sd">        Check whether the hoppings are Hermitian.</span>
<span class="sd">    reciprocal_vectors()</span>
<span class="sd">        Compute the reciprocal lattice vectors for the periodic directions.</span>
<span class="sd">    reduced_basis()</span>
<span class="sd">        Return a reduced set of periodic `BasisVector`s using LLL</span>
<span class="sd">        algorithm.</span>
<span class="sd">    get_states()</span>
<span class="sd">        Extract all `State`s from a `UnitCell` along with their identifying</span>
<span class="sd">        information.</span>
<span class="sd">    get_BZ()</span>
<span class="sd">        Compute the Brillouin zone vertices and faces.</span>
<span class="sd">    get_hamiltonian_function()</span>
<span class="sd">        Generate a function that computes the Hamiltonian matrix</span>
<span class="sd">        for a given k-point.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">v1</span><span class="p">:</span> <span class="n">BasisVector</span>
    <span class="n">v2</span><span class="p">:</span> <span class="n">BasisVector</span>
    <span class="n">v3</span><span class="p">:</span> <span class="n">BasisVector</span>
    <span class="n">sites</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="n">Site</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">hoppings</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span>
        <span class="nb">tuple</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">],</span>
        <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">]],</span>
    <span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">bandstructure</span><span class="p">:</span> <span class="n">BandStructure</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">BandStructure</span><span class="p">)</span>
    <span class="n">bz_grid</span><span class="p">:</span> <span class="n">BrillouinZoneGrid</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">BrillouinZoneGrid</span><span class="p">)</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">volume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the volume of the `UnitCell` using the scalar triple product.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.float64</span>
<span class="sd">            Volume of the unit cell in arbitrary units</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">as_array</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">v1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v3</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">)))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_hermitian</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check whether the hoppings are Hermitian.</span>

<span class="sd">        For each key (destination_state_id, source_state_id) in the</span>
<span class="sd">        hoppings dictionary, check if there is a key</span>
<span class="sd">        (source_state_id, destination_state_id). If so, check that the entries</span>
<span class="sd">        are related by Hermitian conjugation.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            `True` if Hermitian; `False` if not.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hermitian</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoppings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">s1</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">s2</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">hop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="n">hop_transpose</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hoppings</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">),</span> <span class="p">[]))</span>

            <span class="n">hop_neg_conj</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
                <span class="p">((</span><span class="o">-</span><span class="n">d1</span><span class="p">,</span> <span class="o">-</span><span class="n">d2</span><span class="p">,</span> <span class="o">-</span><span class="n">d3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="p">((</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">,</span> <span class="n">d3</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">hop</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">hop_neg_conj</span> <span class="o">!=</span> <span class="n">hop_transpose</span><span class="p">:</span>
                <span class="n">hermitian</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">hermitian</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reciprocal_vectors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the reciprocal lattice vectors for the periodic directions.</span>

<span class="sd">        Calculates the reciprocal lattice vectors corresponding to the</span>
<span class="sd">        periodic directions in the `UnitCell`.</span>
<span class="sd">        The number of reciprocal vectors depends on the number of</span>
<span class="sd">        periodic dimensions (0-3).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[NDArray[np.float64]]</span>
<span class="sd">            List of 3D reciprocal vectors (0 to 3 items depending on</span>
<span class="sd">            periodicity)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">basis_vectors</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">v1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v3</span><span class="p">]</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_periodic</span>
        <span class="p">]</span>
        <span class="n">num_periodic</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">basis_vectors</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">num_periodic</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="k">elif</span> <span class="n">num_periodic</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">a1</span> <span class="o">=</span> <span class="n">basis_vectors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">as_array</span><span class="p">()</span>
            <span class="n">g1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">a1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">g1</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">num_periodic</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">as_array</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">basis_vectors</span><span class="p">]</span>
            <span class="n">normal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span>
            <span class="n">g1</span> <span class="o">=</span> <span class="p">(</span>
                <span class="mi">2</span>
                <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
                <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span>
                <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">normal</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="n">g2</span> <span class="o">=</span> <span class="p">(</span>
                <span class="mi">2</span>
                <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
                <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">normal</span><span class="p">)</span>
                <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">a1</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">g1</span><span class="p">,</span> <span class="n">g2</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">num_periodic</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">as_array</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">basis_vectors</span><span class="p">]</span>
            <span class="n">volume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">))</span>
            <span class="n">g1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">)</span> <span class="o">/</span> <span class="n">volume</span>
            <span class="n">g2</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a3</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span> <span class="o">/</span> <span class="n">volume</span>
            <span class="n">g3</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span> <span class="o">/</span> <span class="n">volume</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">g1</span><span class="p">,</span> <span class="n">g2</span><span class="p">,</span> <span class="n">g3</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid number of periodic vectors.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reduced_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e6</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">BasisVector</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a reduced set of periodic `BasisVector`s using LLL algorithm.</span>

<span class="sd">        Applies the Lenstra-Lenstra-Lovsz (LLL) lattice reduction algorithm</span>
<span class="sd">        to find a more orthogonal set of basis vectors that spans the same</span>
<span class="sd">        lattice.</span>

<span class="sd">        Only the periodic `BasisVector`s are reduced.</span>
<span class="sd">        Non-periodic vectors are left unchanged.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        scale : float = 1e6</span>
<span class="sd">            A float to scale the vectors for integer reduction.</span>
<span class="sd">            Used because the LLL algorithm works with integer matrices.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[BasisVector]</span>
<span class="sd">            A list of BasisVector objects representing the reduced basis</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">v1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v3</span><span class="p">]</span>
        <span class="c1"># Determine which vectors are periodic</span>
        <span class="n">periodic_flags</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">is_periodic</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vs</span><span class="p">]</span>
        <span class="c1"># Extract the periodic vectors. Scale them to be used in reduction</span>
        <span class="n">periodic_vectors</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">scale</span> <span class="o">*</span> <span class="n">vs</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">as_array</span><span class="p">())</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">periodic_flags</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
        <span class="p">]</span>

        <span class="c1"># If there are fewer than 2 periodic vectors,</span>
        <span class="c1"># LLL reduction isn&#39;t meaningful</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">periodic_vectors</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">vs</span>  <span class="c1"># Return unchanged</span>

        <span class="c1"># Reduced vectors</span>
        <span class="n">reduced</span> <span class="o">=</span> <span class="n">DM</span><span class="p">(</span><span class="n">periodic_vectors</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">)</span><span class="o">.</span><span class="n">lll</span><span class="p">()</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
        <span class="c1"># Rebuild full list with reduced periodic vectors in original order</span>
        <span class="n">reduced_basis</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Rescale</span>
        <span class="n">reduced_vectors</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> <span class="o">/</span> <span class="n">scale</span> <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">reduced</span>
        <span class="p">]</span>

        <span class="n">jj</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Index for reduced_vectors</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">periodic_flags</span><span class="p">[</span><span class="n">ii</span><span class="p">]:</span>
                <span class="n">vec</span> <span class="o">=</span> <span class="n">reduced_vectors</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span>
                <span class="n">reduced_basis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">BasisVector</span><span class="p">(</span><span class="o">*</span><span class="n">vec</span><span class="p">,</span> <span class="n">is_periodic</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
                <span class="n">jj</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">reduced_basis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vs</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>  <span class="c1"># Unchanged</span>
        <span class="k">return</span> <span class="n">reduced_basis</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_states</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract all `State`s and their information from a `UnitCell` .</span>

<span class="sd">        This is a helper function used by UI components to get a flattened</span>
<span class="sd">        list of all states in the unit cell, regardless of which site they</span>
<span class="sd">        belong to. It makes it easier to display states in UI components</span>
<span class="sd">        like dropdown menus or lists.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple[list[State], list[tuple[str, uuid.UUID, str, uuid.UUID]]]</span>
<span class="sd">            A tuple containing a list of `State` objects and a list of</span>
<span class="sd">            tuples (site_name, site_id, state_name, state_id)</span>
<span class="sd">            providing context for each state (which site it belongs to).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">states</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">state_info</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">site_id</span><span class="p">,</span> <span class="n">site</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">state_id</span><span class="p">,</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">site</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">states</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
                <span class="n">state_info</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">site</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state_id</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">state_info</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_BZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the Brillouin zone vertices and faces.</span>

<span class="sd">        The Brillouin zone is the Wigner-Seitz cell of the reciprocal lattice.</span>
<span class="sd">        This method calculates the vertices and faces of the Brillouin zone</span>
<span class="sd">        using Voronoi construction. The dimensionality of the BZ depends on</span>
<span class="sd">        the number of periodic dimensions in the unit cell (0-3).</span>

<span class="sd">        For 1D, bz_vertices contains two points defining the BZ boundary.</span>
<span class="sd">        For 2D, bz_faces contains the edges of the 2D BZ polygon.</span>
<span class="sd">        For 3D, bz_faces contains the polygonal faces of the 3D BZ polyhedron.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple[NDArray[NDArray[np.float64]],\</span>
<span class="sd">            NDArray[NDArray[NDArray[np.float64]]]]</span>
<span class="sd">            The first element of the tuple gives the BZ vertex coordinates.</span>
<span class="sd">            The second element gives a list of faces, where each face is</span>
<span class="sd">            defined by vertex points. In 2D, the &quot;faces&quot; are edges.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n_neighbors</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mi">1</span>  <span class="c1"># Number of neighboring reciprocal lattice points to consider</span>
        <span class="p">)</span>
        <span class="n">ranges</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">n_neighbors</span><span class="p">,</span> <span class="n">n_neighbors</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">reciprocal_vectors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reciprocal_vectors</span><span class="p">()</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">reciprocal_vectors</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">bz_vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
            <span class="n">bz_faces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

        <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">g1</span> <span class="o">=</span> <span class="n">reciprocal_vectors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">bz_vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">g1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">g1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]])</span>
            <span class="n">bz_faces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">g1</span> <span class="o">=</span> <span class="n">reciprocal_vectors</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">g2</span> <span class="o">=</span> <span class="n">reciprocal_vectors</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">points</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">ii</span> <span class="o">*</span> <span class="n">g1</span> <span class="o">+</span> <span class="n">jj</span> <span class="o">*</span> <span class="n">g2</span>
                    <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">jj</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">ranges</span><span class="p">,</span> <span class="n">ranges</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">ii</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">jj</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
                <span class="p">]</span>
                <span class="n">all_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">points</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">g1</span> <span class="o">=</span> <span class="n">reciprocal_vectors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">g2</span> <span class="o">=</span> <span class="n">reciprocal_vectors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">g3</span> <span class="o">=</span> <span class="n">reciprocal_vectors</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">points</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">ii</span> <span class="o">*</span> <span class="n">g1</span> <span class="o">+</span> <span class="n">jj</span> <span class="o">*</span> <span class="n">g2</span> <span class="o">+</span> <span class="n">kk</span> <span class="o">*</span> <span class="n">g3</span>
                    <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">,</span> <span class="n">kk</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">ranges</span><span class="p">,</span> <span class="n">ranges</span><span class="p">,</span> <span class="n">ranges</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">ii</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">jj</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">kk</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
                <span class="p">]</span>
                <span class="n">all_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">points</span><span class="p">])</span>

            <span class="n">vor</span> <span class="o">=</span> <span class="n">Voronoi</span><span class="p">(</span><span class="n">all_points</span><span class="p">)</span>

            <span class="c1"># Start by getting the vertices of the Brillouin zone</span>
            <span class="c1"># The first Brillouin zone is the Voronoi cell around</span>
            <span class="c1"># the origin (index 0)</span>
            <span class="n">origin_region</span> <span class="o">=</span> <span class="n">vor</span><span class="o">.</span><span class="n">point_region</span><span class="p">[</span>
                <span class="mi">0</span>
            <span class="p">]</span>  <span class="c1"># Tells which Voronoi cell corresponds to origin point</span>
            <span class="n">vertex_indices</span> <span class="o">=</span> <span class="n">vor</span><span class="o">.</span><span class="n">regions</span><span class="p">[</span>
                <span class="n">origin_region</span>
            <span class="p">]</span>  <span class="c1"># Tells which vertices defining Voronoi cell bound the region</span>

            <span class="c1"># Extract vertices</span>
            <span class="n">bz_vertices</span> <span class="o">=</span> <span class="n">vor</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span>
                <span class="n">vertex_indices</span>
            <span class="p">]</span>  <span class="c1"># Get the coordinates of the vertices</span>

            <span class="c1"># Next, get a list of lists that defines the faces of the BZ</span>
            <span class="n">bz_faces</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># ridge_points is a list of tuples corresponding to</span>
            <span class="c1"># pairs of elements of all_points that are separated by</span>
            <span class="c1"># a Voronoi boundary</span>
            <span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vor</span><span class="o">.</span><span class="n">ridge_points</span><span class="p">):</span>
                <span class="c1"># If one of the elements in the pair is the origin (index 0),</span>
                <span class="c1"># this ridge separates the BZ from its neighbors</span>
                <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># ridge_vertices[num] contains the indices of the vertices</span>
                    <span class="c1"># bounding the ridge</span>
                    <span class="n">ridge_vertices</span> <span class="o">=</span> <span class="n">vor</span><span class="o">.</span><span class="n">ridge_vertices</span><span class="p">[</span><span class="n">num</span><span class="p">]</span>
                    <span class="c1"># finally, get the coordinates of the ridge vertices from</span>
                    <span class="c1"># their indices</span>
                    <span class="n">face</span> <span class="o">=</span> <span class="n">vor</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">ridge_vertices</span><span class="p">]</span>
                    <span class="n">bz_faces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>
            <span class="n">bz_faces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bz_faces</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bz_vertices</span><span class="p">,</span> <span class="n">bz_faces</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_hamiltonian_function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate a function that computes the Hamiltonian matrix.</span>

<span class="sd">        This method creates a closure that precomputes all k-independent</span>
<span class="sd">        data needed for the Hamiltonian, and returns a function that builds</span>
<span class="sd">        the Hamiltonian matrix for any k-point in the Brillouin zone.</span>

<span class="sd">        The dimension of the k-point must match the number of periodic</span>
<span class="sd">        dimensions in the unit cell (1D, 2D, or 3D).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        function</span>
<span class="sd">            A function that takes k-points (numpy array) and returns a</span>
<span class="sd">            complex Hamiltonian matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get the list of all states in the unit cell for</span>
        <span class="c1"># determining the Hamiltonian size</span>
        <span class="n">states</span><span class="p">,</span> <span class="n">state_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_states</span><span class="p">()</span>

        <span class="c1"># Get the reciprocal lattice vectors</span>
        <span class="n">reciprocal_vectors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reciprocal_vectors</span><span class="p">()</span>
        <span class="n">num_periodic</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">reciprocal_vectors</span><span class="p">)</span>

        <span class="c1"># Create a mapping from state IDs to indices in the Hamiltonian matrix</span>
        <span class="c1"># state_id identifies the state, idx is its index in the Hamiltonian</span>
        <span class="c1"># matrix (to keep track of rows/columns)</span>
        <span class="n">state_to_idx</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">state_id</span><span class="p">:</span> <span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">state_id</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">state_info</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="c1"># Store the total number of states for matrix size</span>
        <span class="n">n_states</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">states</span><span class="p">)</span>
        <span class="c1"># Basis vectors as arrays</span>
        <span class="n">v1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">as_array</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">is_periodic</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">v2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2</span><span class="o">.</span><span class="n">as_array</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2</span><span class="o">.</span><span class="n">is_periodic</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">v3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v3</span><span class="o">.</span><span class="n">as_array</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v3</span><span class="o">.</span><span class="n">is_periodic</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="c1"># Define the Hamiltonian function that will be returned</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">hamiltonian</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Compute the Hamiltonian matrix for a given k-point.</span>

<span class="sd">            This function constructs the Hamiltonian matrix in k-space</span>
<span class="sd">            according to the tight-binding model defined by the `UnitCell`</span>
<span class="sd">            and its hopping parameters.</span>
<span class="sd">            The matrix elements include phase factors exp(-i kR) for hoppings</span>
<span class="sd">            between different unit cells, as required by Bloch&#39;s theorem.</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            k : NDArray[np.float64]</span>
<span class="sd">                k-point vector in the basis of reciprocal lattice vectors</span>
<span class="sd">                If the system has n periodic directions, k should be an</span>
<span class="sd">                n-dimensional vector</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            NDArray[np.float64]</span>
<span class="sd">                Complex Hamiltonian matrix of size (n_states, n_states)</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># Validate the k-point dimension matches the number of</span>
            <span class="c1"># periodic directions</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">!=</span> <span class="n">num_periodic</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Momentum does not match system periodicity&quot;</span><span class="p">)</span>

            <span class="c1"># Initialize the Hamiltonian matrix with zeros</span>
            <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_states</span><span class="p">,</span> <span class="n">n_states</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>

            <span class="c1"># Fill the Hamiltonian matrix</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">dest_id</span><span class="p">,</span> <span class="n">source_id</span><span class="p">),</span> <span class="n">hoppings</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoppings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">dest_idx</span> <span class="o">=</span> <span class="n">state_to_idx</span><span class="p">[</span><span class="n">dest_id</span><span class="p">]</span>  <span class="c1"># Destination state index</span>
                <span class="n">source_idx</span> <span class="o">=</span> <span class="n">state_to_idx</span><span class="p">[</span><span class="n">source_id</span><span class="p">]</span>  <span class="c1"># Source state index</span>

                <span class="k">for</span> <span class="n">displacement</span><span class="p">,</span> <span class="n">amplitude</span> <span class="ow">in</span> <span class="n">hoppings</span><span class="p">:</span>
                    <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">,</span> <span class="n">d3</span> <span class="o">=</span> <span class="n">displacement</span>

                    <span class="c1"># Calculate the real-space displacement vector</span>
                    <span class="c1"># This is the sum of the periodic vectors scaled by</span>
                    <span class="c1"># the displacement</span>
                    <span class="n">R</span> <span class="o">=</span> <span class="n">d1</span> <span class="o">*</span> <span class="n">v1</span> <span class="o">+</span> <span class="n">d2</span> <span class="o">*</span> <span class="n">v2</span> <span class="o">+</span> <span class="n">d3</span> <span class="o">*</span> <span class="n">v3</span>

                    <span class="c1"># Apply Bloch phase factor: exp(-i kR)</span>
                    <span class="k">if</span> <span class="n">num_periodic</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">phase</span> <span class="o">=</span> <span class="mf">1.0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">num_periodic</span><span class="p">]))</span>

                    <span class="c1"># Add the term to the Hamiltonian</span>
                    <span class="n">H</span><span class="p">[</span><span class="n">dest_idx</span><span class="p">,</span> <span class="n">source_idx</span><span class="p">]</span> <span class="o">+=</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">phase</span>

            <span class="k">return</span> <span class="n">H</span>

        <span class="k">return</span> <span class="n">hamiltonian</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="TiBi.models.UnitCell.get_BZ" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_BZ</span><span class="p">()</span></code>

<a href="#TiBi.models.UnitCell.get_BZ" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the Brillouin zone vertices and faces.</p>
<p>The Brillouin zone is the Wigner-Seitz cell of the reciprocal lattice.
This method calculates the vertices and faces of the Brillouin zone
using Voronoi construction. The dimensionality of the BZ depends on
the number of periodic dimensions in the unit cell (0-3).</p>
<p>For 1D, bz_vertices contains two points defining the BZ boundary.
For 2D, bz_faces contains the edges of the 2D BZ polygon.
For 3D, bz_faces contains the polygonal faces of the 3D BZ polyhedron.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The first element of the tuple gives the BZ vertex coordinates.
The second element gives a list of faces, where each face is
defined by vertex points. In 2D, the "faces" are edges.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>TiBi/models/unit_cell.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_BZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the Brillouin zone vertices and faces.</span>

<span class="sd">    The Brillouin zone is the Wigner-Seitz cell of the reciprocal lattice.</span>
<span class="sd">    This method calculates the vertices and faces of the Brillouin zone</span>
<span class="sd">    using Voronoi construction. The dimensionality of the BZ depends on</span>
<span class="sd">    the number of periodic dimensions in the unit cell (0-3).</span>

<span class="sd">    For 1D, bz_vertices contains two points defining the BZ boundary.</span>
<span class="sd">    For 2D, bz_faces contains the edges of the 2D BZ polygon.</span>
<span class="sd">    For 3D, bz_faces contains the polygonal faces of the 3D BZ polyhedron.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple[NDArray[NDArray[np.float64]],\</span>
<span class="sd">        NDArray[NDArray[NDArray[np.float64]]]]</span>
<span class="sd">        The first element of the tuple gives the BZ vertex coordinates.</span>
<span class="sd">        The second element gives a list of faces, where each face is</span>
<span class="sd">        defined by vertex points. In 2D, the &quot;faces&quot; are edges.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n_neighbors</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mi">1</span>  <span class="c1"># Number of neighboring reciprocal lattice points to consider</span>
    <span class="p">)</span>
    <span class="n">ranges</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">n_neighbors</span><span class="p">,</span> <span class="n">n_neighbors</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">reciprocal_vectors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reciprocal_vectors</span><span class="p">()</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">reciprocal_vectors</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">bz_vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="n">bz_faces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

    <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="n">reciprocal_vectors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">bz_vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">g1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">g1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]])</span>
        <span class="n">bz_faces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">g1</span> <span class="o">=</span> <span class="n">reciprocal_vectors</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">g2</span> <span class="o">=</span> <span class="n">reciprocal_vectors</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">points</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">ii</span> <span class="o">*</span> <span class="n">g1</span> <span class="o">+</span> <span class="n">jj</span> <span class="o">*</span> <span class="n">g2</span>
                <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">jj</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">ranges</span><span class="p">,</span> <span class="n">ranges</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">ii</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">jj</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">all_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">points</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">g1</span> <span class="o">=</span> <span class="n">reciprocal_vectors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">g2</span> <span class="o">=</span> <span class="n">reciprocal_vectors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">g3</span> <span class="o">=</span> <span class="n">reciprocal_vectors</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">points</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">ii</span> <span class="o">*</span> <span class="n">g1</span> <span class="o">+</span> <span class="n">jj</span> <span class="o">*</span> <span class="n">g2</span> <span class="o">+</span> <span class="n">kk</span> <span class="o">*</span> <span class="n">g3</span>
                <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">,</span> <span class="n">kk</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">ranges</span><span class="p">,</span> <span class="n">ranges</span><span class="p">,</span> <span class="n">ranges</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">ii</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">jj</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">kk</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">all_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">points</span><span class="p">])</span>

        <span class="n">vor</span> <span class="o">=</span> <span class="n">Voronoi</span><span class="p">(</span><span class="n">all_points</span><span class="p">)</span>

        <span class="c1"># Start by getting the vertices of the Brillouin zone</span>
        <span class="c1"># The first Brillouin zone is the Voronoi cell around</span>
        <span class="c1"># the origin (index 0)</span>
        <span class="n">origin_region</span> <span class="o">=</span> <span class="n">vor</span><span class="o">.</span><span class="n">point_region</span><span class="p">[</span>
            <span class="mi">0</span>
        <span class="p">]</span>  <span class="c1"># Tells which Voronoi cell corresponds to origin point</span>
        <span class="n">vertex_indices</span> <span class="o">=</span> <span class="n">vor</span><span class="o">.</span><span class="n">regions</span><span class="p">[</span>
            <span class="n">origin_region</span>
        <span class="p">]</span>  <span class="c1"># Tells which vertices defining Voronoi cell bound the region</span>

        <span class="c1"># Extract vertices</span>
        <span class="n">bz_vertices</span> <span class="o">=</span> <span class="n">vor</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span>
            <span class="n">vertex_indices</span>
        <span class="p">]</span>  <span class="c1"># Get the coordinates of the vertices</span>

        <span class="c1"># Next, get a list of lists that defines the faces of the BZ</span>
        <span class="n">bz_faces</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># ridge_points is a list of tuples corresponding to</span>
        <span class="c1"># pairs of elements of all_points that are separated by</span>
        <span class="c1"># a Voronoi boundary</span>
        <span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vor</span><span class="o">.</span><span class="n">ridge_points</span><span class="p">):</span>
            <span class="c1"># If one of the elements in the pair is the origin (index 0),</span>
            <span class="c1"># this ridge separates the BZ from its neighbors</span>
            <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># ridge_vertices[num] contains the indices of the vertices</span>
                <span class="c1"># bounding the ridge</span>
                <span class="n">ridge_vertices</span> <span class="o">=</span> <span class="n">vor</span><span class="o">.</span><span class="n">ridge_vertices</span><span class="p">[</span><span class="n">num</span><span class="p">]</span>
                <span class="c1"># finally, get the coordinates of the ridge vertices from</span>
                <span class="c1"># their indices</span>
                <span class="n">face</span> <span class="o">=</span> <span class="n">vor</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">ridge_vertices</span><span class="p">]</span>
                <span class="n">bz_faces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>
        <span class="n">bz_faces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bz_faces</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bz_vertices</span><span class="p">,</span> <span class="n">bz_faces</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="TiBi.models.UnitCell.get_hamiltonian_function" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_hamiltonian_function</span><span class="p">()</span></code>

<a href="#TiBi.models.UnitCell.get_hamiltonian_function" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Generate a function that computes the Hamiltonian matrix.</p>
<p>This method creates a closure that precomputes all k-independent
data needed for the Hamiltonian, and returns a function that builds
the Hamiltonian matrix for any k-point in the Brillouin zone.</p>
<p>The dimension of the k-point must match the number of periodic
dimensions in the unit cell (1D, 2D, or 3D).</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="function">function</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A function that takes k-points (numpy array) and returns a
complex Hamiltonian matrix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>TiBi/models/unit_cell.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_hamiltonian_function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a function that computes the Hamiltonian matrix.</span>

<span class="sd">    This method creates a closure that precomputes all k-independent</span>
<span class="sd">    data needed for the Hamiltonian, and returns a function that builds</span>
<span class="sd">    the Hamiltonian matrix for any k-point in the Brillouin zone.</span>

<span class="sd">    The dimension of the k-point must match the number of periodic</span>
<span class="sd">    dimensions in the unit cell (1D, 2D, or 3D).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    function</span>
<span class="sd">        A function that takes k-points (numpy array) and returns a</span>
<span class="sd">        complex Hamiltonian matrix.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the list of all states in the unit cell for</span>
    <span class="c1"># determining the Hamiltonian size</span>
    <span class="n">states</span><span class="p">,</span> <span class="n">state_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_states</span><span class="p">()</span>

    <span class="c1"># Get the reciprocal lattice vectors</span>
    <span class="n">reciprocal_vectors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reciprocal_vectors</span><span class="p">()</span>
    <span class="n">num_periodic</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">reciprocal_vectors</span><span class="p">)</span>

    <span class="c1"># Create a mapping from state IDs to indices in the Hamiltonian matrix</span>
    <span class="c1"># state_id identifies the state, idx is its index in the Hamiltonian</span>
    <span class="c1"># matrix (to keep track of rows/columns)</span>
    <span class="n">state_to_idx</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">state_id</span><span class="p">:</span> <span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">state_id</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">state_info</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1"># Store the total number of states for matrix size</span>
    <span class="n">n_states</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">states</span><span class="p">)</span>
    <span class="c1"># Basis vectors as arrays</span>
    <span class="n">v1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">as_array</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">is_periodic</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">v2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2</span><span class="o">.</span><span class="n">as_array</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2</span><span class="o">.</span><span class="n">is_periodic</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">v3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v3</span><span class="o">.</span><span class="n">as_array</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v3</span><span class="o">.</span><span class="n">is_periodic</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1"># Define the Hamiltonian function that will be returned</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">hamiltonian</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the Hamiltonian matrix for a given k-point.</span>

<span class="sd">        This function constructs the Hamiltonian matrix in k-space</span>
<span class="sd">        according to the tight-binding model defined by the `UnitCell`</span>
<span class="sd">        and its hopping parameters.</span>
<span class="sd">        The matrix elements include phase factors exp(-i kR) for hoppings</span>
<span class="sd">        between different unit cells, as required by Bloch&#39;s theorem.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        k : NDArray[np.float64]</span>
<span class="sd">            k-point vector in the basis of reciprocal lattice vectors</span>
<span class="sd">            If the system has n periodic directions, k should be an</span>
<span class="sd">            n-dimensional vector</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[np.float64]</span>
<span class="sd">            Complex Hamiltonian matrix of size (n_states, n_states)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Validate the k-point dimension matches the number of</span>
        <span class="c1"># periodic directions</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">!=</span> <span class="n">num_periodic</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Momentum does not match system periodicity&quot;</span><span class="p">)</span>

        <span class="c1"># Initialize the Hamiltonian matrix with zeros</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_states</span><span class="p">,</span> <span class="n">n_states</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>

        <span class="c1"># Fill the Hamiltonian matrix</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">dest_id</span><span class="p">,</span> <span class="n">source_id</span><span class="p">),</span> <span class="n">hoppings</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoppings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">dest_idx</span> <span class="o">=</span> <span class="n">state_to_idx</span><span class="p">[</span><span class="n">dest_id</span><span class="p">]</span>  <span class="c1"># Destination state index</span>
            <span class="n">source_idx</span> <span class="o">=</span> <span class="n">state_to_idx</span><span class="p">[</span><span class="n">source_id</span><span class="p">]</span>  <span class="c1"># Source state index</span>

            <span class="k">for</span> <span class="n">displacement</span><span class="p">,</span> <span class="n">amplitude</span> <span class="ow">in</span> <span class="n">hoppings</span><span class="p">:</span>
                <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">,</span> <span class="n">d3</span> <span class="o">=</span> <span class="n">displacement</span>

                <span class="c1"># Calculate the real-space displacement vector</span>
                <span class="c1"># This is the sum of the periodic vectors scaled by</span>
                <span class="c1"># the displacement</span>
                <span class="n">R</span> <span class="o">=</span> <span class="n">d1</span> <span class="o">*</span> <span class="n">v1</span> <span class="o">+</span> <span class="n">d2</span> <span class="o">*</span> <span class="n">v2</span> <span class="o">+</span> <span class="n">d3</span> <span class="o">*</span> <span class="n">v3</span>

                <span class="c1"># Apply Bloch phase factor: exp(-i kR)</span>
                <span class="k">if</span> <span class="n">num_periodic</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">phase</span> <span class="o">=</span> <span class="mf">1.0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">num_periodic</span><span class="p">]))</span>

                <span class="c1"># Add the term to the Hamiltonian</span>
                <span class="n">H</span><span class="p">[</span><span class="n">dest_idx</span><span class="p">,</span> <span class="n">source_idx</span><span class="p">]</span> <span class="o">+=</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">phase</span>

        <span class="k">return</span> <span class="n">H</span>

    <span class="k">return</span> <span class="n">hamiltonian</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="TiBi.models.UnitCell.get_states" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_states</span><span class="p">()</span></code>

<a href="#TiBi.models.UnitCell.get_states" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Extract all <code>State</code>s and their information from a <code>UnitCell</code> .</p>
<p>This is a helper function used by UI components to get a flattened
list of all states in the unit cell, regardless of which site they
belong to. It makes it easier to display states in UI components
like dropdown menus or lists.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="list">list</span>[<a class="autorefs autorefs-internal" title="TiBi.models.State


  
      dataclass
   (TiBi.models.state.State)" href="#TiBi.models.State">State</a>], <span title="list">list</span>[<span title="tuple">tuple</span>[<span title="str">str</span>, <span title="uuid.UUID">UUID</span>, <span title="str">str</span>, <span title="uuid.UUID">UUID</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing a list of <code>State</code> objects and a list of
tuples (site_name, site_id, state_name, state_id)
providing context for each state (which site it belongs to).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>TiBi/models/unit_cell.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_states</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract all `State`s and their information from a `UnitCell` .</span>

<span class="sd">    This is a helper function used by UI components to get a flattened</span>
<span class="sd">    list of all states in the unit cell, regardless of which site they</span>
<span class="sd">    belong to. It makes it easier to display states in UI components</span>
<span class="sd">    like dropdown menus or lists.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple[list[State], list[tuple[str, uuid.UUID, str, uuid.UUID]]]</span>
<span class="sd">        A tuple containing a list of `State` objects and a list of</span>
<span class="sd">        tuples (site_name, site_id, state_name, state_id)</span>
<span class="sd">        providing context for each state (which site it belongs to).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">states</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">state_info</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">site_id</span><span class="p">,</span> <span class="n">site</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">state_id</span><span class="p">,</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">site</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">states</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="n">state_info</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">site</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state_id</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">state_info</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="TiBi.models.UnitCell.is_hermitian" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_hermitian</span><span class="p">()</span></code>

<a href="#TiBi.models.UnitCell.is_hermitian" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check whether the hoppings are Hermitian.</p>
<p>For each key (destination_state_id, source_state_id) in the
hoppings dictionary, check if there is a key
(source_state_id, destination_state_id). If so, check that the entries
are related by Hermitian conjugation.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> if Hermitian; <code>False</code> if not.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>TiBi/models/unit_cell.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_hermitian</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check whether the hoppings are Hermitian.</span>

<span class="sd">    For each key (destination_state_id, source_state_id) in the</span>
<span class="sd">    hoppings dictionary, check if there is a key</span>
<span class="sd">    (source_state_id, destination_state_id). If so, check that the entries</span>
<span class="sd">    are related by Hermitian conjugation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        `True` if Hermitian; `False` if not.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hermitian</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hoppings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">hop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="n">hop_transpose</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hoppings</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">),</span> <span class="p">[]))</span>

        <span class="n">hop_neg_conj</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
            <span class="p">((</span><span class="o">-</span><span class="n">d1</span><span class="p">,</span> <span class="o">-</span><span class="n">d2</span><span class="p">,</span> <span class="o">-</span><span class="n">d3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="p">((</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">,</span> <span class="n">d3</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">hop</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">hop_neg_conj</span> <span class="o">!=</span> <span class="n">hop_transpose</span><span class="p">:</span>
            <span class="n">hermitian</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">hermitian</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="TiBi.models.UnitCell.reciprocal_vectors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reciprocal_vectors</span><span class="p">()</span></code>

<a href="#TiBi.models.UnitCell.reciprocal_vectors" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the reciprocal lattice vectors for the periodic directions.</p>
<p>Calculates the reciprocal lattice vectors corresponding to the
periodic directions in the <code>UnitCell</code>.
The number of reciprocal vectors depends on the number of
periodic dimensions (0-3).</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of 3D reciprocal vectors (0 to 3 items depending on
periodicity)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>TiBi/models/unit_cell.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reciprocal_vectors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the reciprocal lattice vectors for the periodic directions.</span>

<span class="sd">    Calculates the reciprocal lattice vectors corresponding to the</span>
<span class="sd">    periodic directions in the `UnitCell`.</span>
<span class="sd">    The number of reciprocal vectors depends on the number of</span>
<span class="sd">    periodic dimensions (0-3).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list[NDArray[np.float64]]</span>
<span class="sd">        List of 3D reciprocal vectors (0 to 3 items depending on</span>
<span class="sd">        periodicity)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">basis_vectors</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">v1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v3</span><span class="p">]</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">is_periodic</span>
    <span class="p">]</span>
    <span class="n">num_periodic</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">basis_vectors</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">num_periodic</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">elif</span> <span class="n">num_periodic</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">a1</span> <span class="o">=</span> <span class="n">basis_vectors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">as_array</span><span class="p">()</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">a1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">g1</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">num_periodic</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">as_array</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">basis_vectors</span><span class="p">]</span>
        <span class="n">normal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mi">2</span>
            <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
            <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span>
            <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">normal</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mi">2</span>
            <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
            <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">normal</span><span class="p">)</span>
            <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">a1</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">g1</span><span class="p">,</span> <span class="n">g2</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">num_periodic</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">as_array</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">basis_vectors</span><span class="p">]</span>
        <span class="n">volume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">))</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">)</span> <span class="o">/</span> <span class="n">volume</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a3</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span> <span class="o">/</span> <span class="n">volume</span>
        <span class="n">g3</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span> <span class="o">/</span> <span class="n">volume</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">g1</span><span class="p">,</span> <span class="n">g2</span><span class="p">,</span> <span class="n">g3</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid number of periodic vectors.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="TiBi.models.UnitCell.reduced_basis" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reduced_basis</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">1000000.0</span><span class="p">)</span></code>

<a href="#TiBi.models.UnitCell.reduced_basis" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return a reduced set of periodic <code>BasisVector</code>s using LLL algorithm.</p>
<p>Applies the Lenstra-Lenstra-Lovsz (LLL) lattice reduction algorithm
to find a more orthogonal set of basis vectors that spans the same
lattice.</p>
<p>Only the periodic <code>BasisVector</code>s are reduced.
Non-periodic vectors are left unchanged.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>scale</code>
            </td>
            <td>
                  <code>float = 1e6</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A float to scale the vectors for integer reduction.
Used because the LLL algorithm works with integer matrices.</p>
              </div>
            </td>
            <td>
                  <code>1000000.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="TiBi.models.BasisVector


  
      dataclass
   (TiBi.models.basis_vector.BasisVector)" href="#TiBi.models.BasisVector">BasisVector</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of BasisVector objects representing the reduced basis</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>TiBi/models/unit_cell.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reduced_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e6</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">BasisVector</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a reduced set of periodic `BasisVector`s using LLL algorithm.</span>

<span class="sd">    Applies the Lenstra-Lenstra-Lovsz (LLL) lattice reduction algorithm</span>
<span class="sd">    to find a more orthogonal set of basis vectors that spans the same</span>
<span class="sd">    lattice.</span>

<span class="sd">    Only the periodic `BasisVector`s are reduced.</span>
<span class="sd">    Non-periodic vectors are left unchanged.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    scale : float = 1e6</span>
<span class="sd">        A float to scale the vectors for integer reduction.</span>
<span class="sd">        Used because the LLL algorithm works with integer matrices.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list[BasisVector]</span>
<span class="sd">        A list of BasisVector objects representing the reduced basis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">v1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v3</span><span class="p">]</span>
    <span class="c1"># Determine which vectors are periodic</span>
    <span class="n">periodic_flags</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">is_periodic</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vs</span><span class="p">]</span>
    <span class="c1"># Extract the periodic vectors. Scale them to be used in reduction</span>
    <span class="n">periodic_vectors</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">scale</span> <span class="o">*</span> <span class="n">vs</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">as_array</span><span class="p">())</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">periodic_flags</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
    <span class="p">]</span>

    <span class="c1"># If there are fewer than 2 periodic vectors,</span>
    <span class="c1"># LLL reduction isn&#39;t meaningful</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">periodic_vectors</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">vs</span>  <span class="c1"># Return unchanged</span>

    <span class="c1"># Reduced vectors</span>
    <span class="n">reduced</span> <span class="o">=</span> <span class="n">DM</span><span class="p">(</span><span class="n">periodic_vectors</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">)</span><span class="o">.</span><span class="n">lll</span><span class="p">()</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
    <span class="c1"># Rebuild full list with reduced periodic vectors in original order</span>
    <span class="n">reduced_basis</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Rescale</span>
    <span class="n">reduced_vectors</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> <span class="o">/</span> <span class="n">scale</span> <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">reduced</span>
    <span class="p">]</span>

    <span class="n">jj</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Index for reduced_vectors</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">periodic_flags</span><span class="p">[</span><span class="n">ii</span><span class="p">]:</span>
            <span class="n">vec</span> <span class="o">=</span> <span class="n">reduced_vectors</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span>
            <span class="n">reduced_basis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">BasisVector</span><span class="p">(</span><span class="o">*</span><span class="n">vec</span><span class="p">,</span> <span class="n">is_periodic</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="n">jj</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reduced_basis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vs</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>  <span class="c1"># Unchanged</span>
    <span class="k">return</span> <span class="n">reduced_basis</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="TiBi.models.UnitCell.volume" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">volume</span><span class="p">()</span></code>

<a href="#TiBi.models.UnitCell.volume" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the volume of the <code>UnitCell</code> using the scalar triple product.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.float64">float64</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Volume of the unit cell in arbitrary units</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>TiBi/models/unit_cell.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">volume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the volume of the `UnitCell` using the scalar triple product.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.float64</span>
<span class="sd">        Volume of the unit cell in arbitrary units</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">as_array</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">v1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v3</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="TiBi.models.factories.bz_point_selection_init" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">TiBi</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">factories</span><span class="o">.</span><span class="n">bz_point_selection_init</span><span class="p">()</span></code>

<a href="#TiBi.models.factories.bz_point_selection_init" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

        <p>Initialize the selection dictonary for points in the Brillouin zone.</p>
<p>Each key corresponds to a point type (vertex, edge, face), while
the entries give the cardinal indices of the selected points.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with keys 'vertex', 'edge', and 'face', each initialized
to None. During use, the entries are set to the indices
of the selected points.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>TiBi/models/factories.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bz_point_selection_init</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the selection dictonary for points in the Brillouin zone.</span>

<span class="sd">    Each key corresponds to a point type (vertex, edge, face), while</span>
<span class="sd">    the entries give the cardinal indices of the selected points.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        A dictionary with keys &#39;vertex&#39;, &#39;edge&#39;, and &#39;face&#39;, each initialized</span>
<span class="sd">        to None. During use, the entries are set to the indices</span>
<span class="sd">        of the selected points.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;vertex&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s2">&quot;edge&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s2">&quot;face&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">}</span>  <span class="c1"># Indices of the selected high-symmetry points in the BZ</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="TiBi.models.factories.bz_point_lists_init" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">TiBi</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">factories</span><span class="o">.</span><span class="n">bz_point_lists_init</span><span class="p">()</span></code>

<a href="#TiBi.models.factories.bz_point_lists_init" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

        <p>Initialize the dictonary of points in the Brillouin zone.</p>
<p>Each key corresponds to a point type (vertex, edge, face), while
the entries are lists of high-symmetry points in the Brillouin zone.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with keys 'vertex', 'edge', and 'face', each initialized
to empty lists. During use, the entries are set to the lists of
of the high-symmetry points.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>TiBi/models/factories.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bz_point_lists_init</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the dictonary of points in the Brillouin zone.</span>

<span class="sd">    Each key corresponds to a point type (vertex, edge, face), while</span>
<span class="sd">    the entries are lists of high-symmetry points in the Brillouin zone.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        A dictionary with keys &#39;vertex&#39;, &#39;edge&#39;, and &#39;face&#39;, each initialized</span>
<span class="sd">        to empty lists. During use, the entries are set to the lists of</span>
<span class="sd">        of the high-symmetry points.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;vertex&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;edge&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;face&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">}</span>  <span class="c1"># Lists of the high-symmetry points in the BZ, grouped by type</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="TiBi.models.factories.mk_new_site" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">TiBi</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">factories</span><span class="o">.</span><span class="n">mk_new_site</span><span class="p">()</span></code>

<a href="#TiBi.models.factories.mk_new_site" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

        <p>Create a new site with default values.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="TiBi.models.Site


  
      dataclass
  " href="#TiBi.models.Site">Site</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new <code>Site</code> object with default values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>TiBi/models/factories.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mk_new_site</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new site with default values.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Site</span>
<span class="sd">        A new `Site` object with default values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;New Site&quot;</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Fractional coordinate along first basis vector</span>
    <span class="n">c2</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Fractional coordinate along second basis vector</span>
    <span class="n">c3</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Fractional coordinate along third basis vector</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">DEFAULT_SITE_SIZE</span>
    <span class="n">color</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">Site</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="TiBi.models.factories.mk_new_state" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">TiBi</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">factories</span><span class="o">.</span><span class="n">mk_new_state</span><span class="p">()</span></code>

<a href="#TiBi.models.factories.mk_new_state" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

        <p>Create a new state with default values.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="TiBi.models.State


  
      dataclass
  " href="#TiBi.models.State">State</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new <code>State</code> object with default values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>TiBi/models/factories.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mk_new_state</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new state with default values.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    State</span>
<span class="sd">        A new `State` object with default values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;New State&quot;</span>
    <span class="k">return</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="TiBi.models.factories.mk_new_unit_cell" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">TiBi</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">factories</span><span class="o">.</span><span class="n">mk_new_unit_cell</span><span class="p">()</span></code>

<a href="#TiBi.models.factories.mk_new_unit_cell" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">

        <p>Create a new unit cell with default values.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="TiBi.models.UnitCell


  
      dataclass
  " href="#TiBi.models.UnitCell">UnitCell</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new <code>UnitCell</code> object with default values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>TiBi/models/factories.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mk_new_unit_cell</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new unit cell with default values.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    UnitCell</span>
<span class="sd">        A new `UnitCell` object with default values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;New Unit Cell&quot;</span>
    <span class="n">v1</span> <span class="o">=</span> <span class="n">BasisVector</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Unit vector along x-axis</span>
    <span class="n">v2</span> <span class="o">=</span> <span class="n">BasisVector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Unit vector along y-axis</span>
    <span class="n">v3</span> <span class="o">=</span> <span class="n">BasisVector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Unit vector along z-axis</span>

    <span class="k">return</span> <span class="n">UnitCell</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.instant", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>